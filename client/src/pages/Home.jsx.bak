import { useState } from 'react';
import { Link } from 'react-router-dom';
import { FaBed, FaBath, FaRulerCombined, FaMapMarkerAlt, FaStar, FaArrowRight } from 'react-icons/fa';
import HomeHero from '../components/home/HomeHero';
import FeaturedPropertiesGrid from '../components/properties/FeaturedPropertiesGrid';

// Generate dynamic layout for featured properties
const generateLayout = (items) => {
  const layouts = [
    // Layout 1: One large, two small
    {
      gridTemplateAreas: `'big big small1' 'big big small2'`,
      items: [
        { ...items[0], size: 'big' },
        { ...items[1], size: 'small' },
        { ...items[2], size: 'small' }
      ]
    },
    // Layout 2: Two medium side by side with one below
    {
      gridTemplateAreas: `'medium1 medium2' 'large large'`,
      items: [
        { ...items[0], size: 'large' },
        { ...items[1], size: 'medium' },
        { ...items[2], size: 'medium' }
      ]
    },
    // Layout 3: Three columns with middle one taller
    {
      gridTemplateAreas: `'small1 medium small2' 'tall tall tall'`,
      items: [
        { ...items[0], size: 'tall' },
        { ...items[1], size: 'small' },
        { ...items[2], size: 'medium' }
      ]
    }
  ];

  // Layout that shows all properties in a responsive grid
  return {
    gridTemplateAreas: `'big big small1' 'big big small2' 'medium1 medium2 medium3'`,
    items: items.map((item, index) => ({
      ...item,
      size: index === 0 ? 'big' : (index < 3 ? 'small' : 'medium')
    }))
  };
};

// Mock data - in a real app, this would come from an API
const featuredPropertiesData = [
  {
    id: 1,
    title: 'Luxury Villa in Karen',
    location: 'Karen, Nairobi',
    price: 45000000,
    type: 'For Sale',
    beds: 5,
    baths: 4,
    sqft: 4500,
    image: 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
    featured: true
  },
  {
    id: 2,
    title: 'Modern Apartment in Westlands',
    location: 'Westlands, Nairobi',
    price: 25000,
    type: 'For Rent',
    beds: 3,
    baths: 2,
    sqft: 1800,
    image: 'https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
    featured: true
  },
  {
    id: 3,
    title: 'Beachfront Villa in Diani',
    location: 'Diani, Mombasa',
    price: 68000000,
    type: 'For Sale',
    beds: 6,
    baths: 5,
    sqft: 5200,
    image: 'https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
    featured: true
  },
  {
    id: 4,
    title: 'Mountain View Cottage',
    location: 'Mount Kenya',
    price: 38000000,
    type: 'For Sale',
    beds: 4,
    baths: 3,
    sqft: 3200,
    image: 'https://images.unsplash.com/photo-1564501049412-61c2a3083791?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
    featured: true
  },
  {
    id: 5,
    title: 'City Center Penthouse',
    location: 'Nairobi CBD',
    price: 85000,
    type: 'For Rent',
    beds: 3,
    baths: 3,
    sqft: 2800,
    image: 'https://images.unsplash.com/photo-1484154218962-a1970026899a?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
    featured: true
  },
  {
    id: 6,
    title: 'Lakeside Mansion',
    location: 'Naivasha',
    price: 75000000,
    type: 'For Sale',
    beds: 7,
    baths: 6,
    sqft: 6800,
    image: 'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
    featured: true
  },
  {
    id: 7,
    title: 'Golf Course Villa',
    location: 'Muthaiga, Nairobi',
    price: 92000000,
    type: 'For Sale',
    beds: 6,
    baths: 5,
    sqft: 5800,
    image: 'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
    featured: true
  },
  {
    id: 8,
    title: 'Modern Townhouse',
    location: 'Runda, Nairobi',
    price: 65000,
    type: 'For Rent',
    beds: 4,
    baths: 3.5,
    sqft: 3200,
    image: 'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
    featured: true
  },
  {
    id: 9,
    title: 'Beach House',
    location: 'Watamu',
    price: 120000000,
    type: 'For Sale',
    beds: 5,
    baths: 4.5,
    sqft: 5200,
    image: 'https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
    featured: true
  },
  {
    id: 10,
    title: 'Luxury Apartment',
    location: 'Kilimani, Nairobi',
    price: 45000,
    type: 'For Rent',
    beds: 3,
    baths: 2,
    sqft: 2200,
    image: 'https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
    featured: true
  }
];

// Generate initial layout for properties
const initialPropertiesLayout = generateLayout(featuredPropertiesData);

const featuredHotels = [
  {
    id: 1,
    name: 'Serena Beach Resort',
    location: 'Mombasa',
    price: 25000,
    rating: 4.8,
    reviews: 124,
    image: 'https://images.unsplash.com/photo-1542314831-068cd1dbfeeb?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80'
  },
  {
    id: 2,
    name: 'Mount Kenya Safari Club',
    location: 'Nanyuki',
    price: 32000,
    rating: 4.9,
    reviews: 98,
    image: 'https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80'
  },
  {
    id: 3,
    name: 'Mara Serena Safari Lodge',
    location: 'Maasai Mara',
    price: 45000,
    rating: 4.7,
    reviews: 156,
    image: 'https://images.unsplash.com/photo-1520250497591-112f2f40a3f4?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80'
  },
  {
    id: 4,
    name: 'Villa Rosa Kempinski',
    location: 'Nairobi',
    price: 38000,
    rating: 4.9,
    reviews: 215,
    image: 'https://images.unsplash.com/photo-1566074208879-1dff3b341da4?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80'
  },
  {
    id: 5,
    name: 'Hemingways Nairobi',
    location: 'Karen, Nairobi',
    price: 42000,
    rating: 4.8,
    reviews: 187,
    image: 'https://images.unsplash.com/photo-1520256862855-39804cf61ec5?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80'
  }
];

const Home = () => {
  const [featuredProperties] = useState(initialPropertiesLayout);
  
  // Handle favorite toggle
  const handleFavoriteToggle = (propertyId, isFavorite) => {
    console.log(`Property ${propertyId} is now ${isFavorite ? 'favorited' : 'unfavorited'}`);
    // In a real app, you would update the favorite status in your state/API here
  };

  const formatPrice = (price) => {
    return new Intl.NumberFormat('en-US', {
      style: 'currency',
      currency: 'KES',
      maximumFractionDigits: 0
    }).format(price);
  };

  const renderPropertyCard = (property, index) => {
    const gridArea = property.size === 'big' ? 'big' : 
                    property.size === 'large' ? 'large' : 
                    property.size === 'tall' ? 'tall' : 
                    property.size === 'medium' ? `medium${index + 1}` : `small${index + 1}`;
    
    return (
      <div 
        key={property.id}
        className={`property-card property-card--${property.size}`}
        style={{
          gridArea,
          height: property.size === 'tall' ? '100%' : 'auto',
          minHeight: property.size === 'big' || property.size === 'large' ? '400px' : '200px',
          position: 'relative',
          overflow: 'hidden',
          borderRadius: '8px',
          boxShadow: '0 5px 15px rgba(0,0,0,0.1)',
          transition: 'all 0.3s ease',
          cursor: 'pointer'
        }}
        onMouseEnter={(e) => {
          e.currentTarget.style.transform = 'translateY(-5px)';
          e.currentTarget.style.boxShadow = '0 10px 25px rgba(0,0,0,0.15)';
        }}
        onMouseLeave={(e) => {
          e.currentTarget.style.transform = 'translateY(0)';
          e.currentTarget.style.boxShadow = '0 5px 15px rgba(0,0,0,0.1)';
        }}
      >
        <div 
          className="property-card__image"
          style={{
            width: '100%',
            height: '100%',
            backgroundImage: `url(${property.image})`,
            backgroundSize: 'cover',
            backgroundPosition: 'center',
            position: 'relative',
            display: 'flex',
            flexDirection: 'column',
            justifyContent: 'flex-end',
            padding: '20px',
            color: '#fff',
            textShadow: '0 1px 3px rgba(0,0,0,0.5)'
          }}
        >
          <span 
            className="property-card__type"
            style={{
              position: 'absolute',
              top: '15px',
              right: '15px',
              background: 'rgba(0,0,0,0.7)',
              color: '#fff',
              padding: '5px 10px',
              borderRadius: '4px',
              fontSize: '12px',
              fontWeight: '600',
              textTransform: 'uppercase',
              letterSpacing: '1px'
            }}
          >
            {property.type}
          </span>
          <div className="property-card__content">
            <h3 style={{ 
              fontSize: property.size === 'big' || property.size === 'large' ? '1.8rem' : '1.2rem',
              marginBottom: '10px'
            }}>
              {property.title}
            </h3>
            <p style={{ 
              display: 'flex', 
              alignItems: 'center',
              marginBottom: '10px',
              fontSize: '0.9rem'
            }}>
              <FaMapMarkerAlt style={{ marginRight: '5px' }} />
              {property.location}
            </p>
            <div style={{ 
              display: 'flex', 
              justifyContent: 'space-between',
              marginBottom: '15px',
              fontSize: '0.9rem'
            }}>
              <span style={{ display: 'flex', alignItems: 'center' }}>
                <FaBed style={{ marginRight: '5px' }} />
                {property.beds} Beds
              </span>
              <span style={{ display: 'flex', alignItems: 'center' }}>
                <FaBath style={{ marginRight: '5px' }} />
                {property.baths} Baths
              </span>
              <span style={{ display: 'flex', alignItems: 'center' }}>
                <FaRulerCombined style={{ marginRight: '5px' }} />
                {property.sqft} sqft
              </span>
            </div>
            <div style={{ 
              display: 'flex', 
              justifyContent: 'space-between',
              alignItems: 'center',
              fontSize: '1.1rem',
              fontWeight: '600'
            }}>
              <span>{formatPrice(property.price)}</span>
              <Link 
                to={`/properties/${property.id}`}
                style={{
                  color: '#fff',
                  textDecoration: 'none',
                  padding: '5px 15px',
                  background: 'rgba(0,0,0,0.7)',
                  borderRadius: '4px',
                  transition: 'all 0.3s ease'
                }}
                onMouseOver={(e) => (e.currentTarget.style.background = 'rgba(0,0,0,0.9)')}
                onMouseOut={(e) => (e.currentTarget.style.background = 'rgba(0,0,0,0.7)')}
              >
                View Details
              </Link>
            </div>
          </div>
        </div>
      </div>
    );
  };

  return (
    <div className="home">
      <HomeHero />

      {/* Featured Properties Section */}
      <section className="section" style={{ 
        padding: '60px 0',
        backgroundColor: '#f9f9f9',
        position: 'relative'
      }}>
        <div className="container" style={{ position: 'relative', zIndex: 1 }}>
          <div className="section__header" style={{ 
            marginBottom: '40px', 
            textAlign: 'center',
            maxWidth: '900px',
            marginLeft: 'auto',
            marginRight: 'auto'
          }}>
            <h2 className="section__title" style={{ 
              fontSize: '2.5rem', 
              marginBottom: '15px', 
              color: '#2c3e50',
              fontWeight: '700',
              position: 'relative',
              display: 'inline-block',
              paddingBottom: '15px'
            }}>
              <span style={{
                position: 'relative',
                zIndex: 1
              }}>
                Featured Properties
              </span>
              <span style={{
                position: 'absolute',
                bottom: '0',
                left: '50%',
                transform: 'translateX(-50%)',
                width: '80px',
                height: '4px',
                backgroundColor: '#e74c3c',
                borderRadius: '2px'
              }}></span>
            </h2>
            <p style={{ 
              fontSize: '1.1rem', 
              color: '#7f8c8d',
              marginBottom: '30px',
              lineHeight: '1.6',
              maxWidth: '700px',
              marginLeft: 'auto',
              marginRight: 'auto'
            }}>
              Discover our handpicked selection of premium properties from around the country. 
              Each property is carefully selected to ensure the highest standards of quality and comfort.
            </p>
            <div style={{ display: 'flex', gap: '15px', justifyContent: 'center', flexWrap: 'wrap' }}>
              <Link 
                to="/properties" 
                className="section__link" 
                style={{ 
                  display: 'inline-flex', 
                  alignItems: 'center',
                  color: '#fff',
                  textDecoration: 'none',
                  fontWeight: '600',
                  fontSize: '0.95rem',
                  padding: '12px 28px',
                  backgroundColor: '#e74c3c',
                  borderRadius: '4px',
                  transition: 'all 0.3s ease',
                  textTransform: 'uppercase',
                  letterSpacing: '0.5px'
                }}
                onMouseEnter={(e) => {
                  e.currentTarget.style.backgroundColor = '#c0392b';
                  e.currentTarget.style.transform = 'translateY(-2px)';
                }}
                onMouseLeave={(e) => {
                  e.currentTarget.style.backgroundColor = '#e74c3c';
                  e.currentTarget.style.transform = 'translateY(0)';
                }}
              >
                View All Properties
                <FaArrowRight style={{ marginLeft: '8px', fontSize: '0.9rem' }} />
              </Link>
              <Link 
                to="/contact" 
                className="section__link" 
                style={{ 
                  display: 'inline-flex', 
                  alignItems: 'center',
                  color: '#2c3e50',
                  textDecoration: 'none',
                  fontWeight: '600',
                  fontSize: '0.95rem',
                  padding: '12px 28px',
                  backgroundColor: 'transparent',
                  borderRadius: '4px',
                  transition: 'all 0.3s ease',
                  border: '2px solid #2c3e50',
                  textTransform: 'uppercase',
                  letterSpacing: '0.5px'
                }}
                onMouseEnter={(e) => {
                  e.currentTarget.style.backgroundColor = '#2c3e50';
                  e.currentTarget.style.color = '#fff';
                  e.currentTarget.style.transform = 'translateY(-2px)';
                }}
                onMouseLeave={(e) => {
                  e.currentTarget.style.backgroundColor = 'transparent';
                  e.currentTarget.style.color = '#2c3e50';
                  e.currentTarget.style.transform = 'translateY(0)';
                }}
              >
                Contact Agent
              </Link>
            </div>
          </div>

          {/* Featured Properties Grid */}
          <div style={{ padding: '0 20px' }}>
            <FeaturedPropertiesGrid 
              properties={featuredPropertiesData} 
              onFavoriteToggle={handleFavoriteToggle}
            />
          </div>

          {/* View More Button */}
          <div style={{ textAlign: 'center', marginTop: '40px' }}>
            <Link 
              to="/properties"
              style={{
                display: 'inline-flex',
                alignItems: 'center',
                color: '#e74c3c',
                textDecoration: 'none',
                fontWeight: '600',
                fontSize: '1rem',
                padding: '10px 24px',
                border: '2px solid #e74c3c',
                borderRadius: '4px',
                transition: 'all 0.3s ease',
              }}
              onMouseEnter={(e) => {
                e.currentTarget.style.backgroundColor = '#e74c3c';
                e.currentTarget.style.color = '#fff';
              }}
              onMouseLeave={(e) => {
                e.currentTarget.style.backgroundColor = 'transparent';
                e.currentTarget.style.color = '#e74c3c';
              }}
            >
              View More Properties
              <FaArrowRight style={{ marginLeft: '8px', fontSize: '0.9rem' }} />
            </Link>
          </div>
        </div>
      </section>

      {/* Featured Hotels Section */}
      <section className="section" style={{ 
        padding: '60px 0',
        backgroundColor: '#f9f9f9',
        position: 'relative'
      }}>
            properties={featuredPropertiesData} 
            onFavoriteToggle={handleFavoriteToggle}
          />
        </div>

        {/* View More Button */}
        <div style={{ textAlign: 'center', marginTop: '40px' }}>
          <Link 
            to="/properties"
            style={{
              display: 'inline-flex',
        <div className="container">
          <div className="section__header" style={{ marginBottom: '40px', textAlign: 'center' }}>
            <h2 className="section__title" style={{ fontSize: '2.5rem', marginBottom: '15px', color: '#2c3e50' }}>Featured Hotels</h2>
            <Link to="/hotels" className="section__link" style={{ 
              display: 'inline-flex', 
              alignItems: 'center',
              color: '#3498db',
              textDecoration: 'none',
              fontWeight: '500',
              transition: 'all 0.3s ease'
            }}>
              View All Hotels <FaArrowRight style={{ marginLeft: '8px' }} />
            </Link>
          </div>
          
          <div 
            className="hotels-grid" 
            style={{
              display: 'grid',
              gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))',
              gap: '30px',
              marginBottom: '40px'
            }}
          >
            {featuredHotels.map(hotel => (
              <div 
                key={hotel.id}
                className="hotel-card"
                style={{
                  backgroundColor: '#fff',
                  borderRadius: '8px',
                  overflow: 'hidden',
                  boxShadow: '0 5px 15px rgba(0,0,0,0.1)',
                  transition: 'all 0.3s ease',
                  cursor: 'pointer'
                }}
                onMouseEnter={(e) => {
                  e.currentTarget.style.transform = 'translateY(-5px)';
                  e.currentTarget.style.boxShadow = '0 10px 25px rgba(0,0,0,0.15)';
                }}
                onMouseLeave={(e) => {
                  e.currentTarget.style.transform = 'translateY(0)';
                  e.currentTarget.style.boxShadow = '0 5px 15px rgba(0,0,0,0.1)';
                }}
              >
                <div 
                  className="hotel-card__image"
                  style={{
                    height: '200px',
                    backgroundImage: `url(${hotel.image})`,
                    backgroundSize: 'cover',
                    backgroundPosition: 'center',
                    position: 'relative'
                  }}
                >
                  <div 
                    className="hotel-card__rating"
                    style={{
                      position: 'absolute',
                      top: '15px',
                      right: '15px',
                      backgroundColor: 'rgba(0,0,0,0.7)',
                      color: '#fff',
                      padding: '5px 10px',
                      borderRadius: '20px',
                      display: 'flex',
                      alignItems: 'center',
                      fontSize: '14px',
                      fontWeight: '600'
                    }}
                  >
                    <FaStar style={{ color: '#ffc107', marginRight: '5px' }} />
                    {hotel.rating}
                  </div>
                </div>
                <div className="hotel-card__content" style={{ padding: '20px' }}>
                  <h3 style={{ 
                    fontSize: '1.3rem',
                    marginBottom: '10px',
                    color: '#2c3e50'
                  }}>
                    {hotel.name}
                  </h3>
                  <p style={{ 
                    display: 'flex', 
                    alignItems: 'center',
                    color: '#7f8c8d',
                    marginBottom: '15px',
                    fontSize: '0.9rem'
                  }}>
                    <FaMapMarkerAlt style={{ marginRight: '5px' }} />
                    {hotel.location}
                  </p>
                  <div style={{ 
                    display: 'flex', 
                    justifyContent: 'space-between',
                    alignItems: 'center',
                    paddingTop: '15px',
                    borderTop: '1px solid #eee'
                  }}>
                    <div>
                      <span style={{ 
                        display: 'block',
                        fontSize: '1.1rem',
                        fontWeight: '600',
                        color: '#2c3e50',
                        marginBottom: '5px'
                      }}>
                        {formatPrice(hotel.price)}
                        <span style={{ 
                          fontSize: '0.9rem',
                          fontWeight: '400',
                          color: '#7f8c8d',
                          marginLeft: '5px'
                        }}>
                          /night
                        </span>
                      </span>
                      <span style={{ 
                        fontSize: '0.9rem',
                        color: '#7f8c8d'
                      }}>
                        {hotel.reviews} reviews
                      </span>
                    </div>
                    <Link 
                      to={`/hotels/${hotel.id}`}
                      style={{
                        color: '#3498db',
                        textDecoration: 'none',
                        fontWeight: '500',
                        display: 'flex',
                        alignItems: 'center',
                        transition: 'all 0.3s ease'
                      }}
                      onMouseOver={(e) => (e.currentTarget.style.color = '#2980b9')}
                      onMouseOut={(e) => (e.currentTarget.style.color = '#3498db')}
                    >
                      View Details
                      <FaArrowRight style={{ marginLeft: '5px' }} />
                    </Link>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>
      </section>
    </div>
  );
};

export default Home;
